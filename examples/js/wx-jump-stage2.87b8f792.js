(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["wx-jump-stage2"],{"02f4":function(t,e,i){var n=i("4588"),r=i("be13");t.exports=function(t){return function(e,i){var a,o,s=String(r(e)),h=n(i),c=s.length;return h<0||h>=c?t?"":void 0:(a=s.charCodeAt(h),a<55296||a>56319||h+1===c||(o=s.charCodeAt(h+1))<56320||o>57343?t?s.charAt(h):a:t?s.slice(h,h+2):o-56320+(a-55296<<10)+65536)}}},"1c4c":function(t,e,i){"use strict";var n=i("9b43"),r=i("5ca1"),a=i("4bf8"),o=i("1fa8"),s=i("33a4"),h=i("9def"),c=i("f1ae"),l=i("27ee");r(r.S+r.F*!i("5cc5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,i,r,u,p=a(t),g="function"==typeof this?this:Array,d=arguments.length,f=d>1?arguments[1]:void 0,v=void 0!==f,y=0,m=l(p);if(v&&(f=n(f,d>2?arguments[2]:void 0,2)),void 0==m||g==Array&&s(m))for(e=h(p.length),i=new g(e);e>y;y++)c(i,y,v?f(p[y],y):p[y]);else for(u=m.call(p),i=new g;!(r=u.next()).done;y++)c(i,y,v?o(u,f,[r.value,y],!0):r.value);return i.length=y,i}})},"386b":function(t,e,i){var n=i("5ca1"),r=i("79e5"),a=i("be13"),o=/"/g,s=function(t,e,i,n){var r=String(a(t)),s="<"+e;return""!==i&&(s+=" "+i+'="'+String(n).replace(o,"&quot;")+'"'),s+">"+r+"</"+e+">"};t.exports=function(t,e){var i={};i[t]=e(s),n(n.P+n.F*r((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",i)}},"5df3":function(t,e,i){"use strict";var n=i("02f4")(!0);i("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})}))},"673e":function(t,e,i){"use strict";i("386b")("sub",(function(t){return function(){return t(this,"sub","","")}}))},8448:function(t,e,i){},"8fad":function(t,e,i){"use strict";var n=i("8448"),r=i.n(n);r.a},cfd0:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"jump-world"},[i("canvas",{attrs:{id:"jump-world-canvas"}})])}],a=i("768b"),o=(i("ac6a"),i("d225")),s=i("b0b4"),h=(i("673e"),i("5df3"),i("1c4c"),i("5a89")),c=i("22b5"),l=Math.random,u=Math.sqrt,p=Math.floor,g=Math.pow,d=Math.sin,f=Math.cos,v=Math.tan,y=Math.PI,m=0,w=function(){return m++},b=function(){return m=0},S=[6799930,15114812,16084076,9474969,4235007,16777215];function x(t,e,i,n,r,a){var o=t*(y/180),s=e*(y/180),h=f(o)*n,c=d(o)*(a-r-i/v(o));if(!(h>c)){var l=h+(c-h)/2,u=l/v(o),p=d(s)*u,g=f(s)*u;return{x:p,y:l,z:g}}console.warn("警告: 垂直角度太小了!")}var P=new h["MeshLambertMaterial"],A=new h["BoxBufferGeometry"](1,1,1,10,4,10);A.userData.type="box";var z=new h["CylinderBufferGeometry"](1,1,1,30,5);z.userData.type="Cylinder";var M=function(t){t.geometry&&(t.geometry.dispose(),t.geometry=null),t.material&&(t.material.dispose(),t.material=null),t.parent.remove(t),t.parent=null,t=null},j=function(t){return t[p(l()*t.length)]},Y=function(t,e){return p(l()*(e-t+1))+t},C=function t(e){var i=t.box3||(t.box3=new h["Box3"]);return i.setFromObject(e),i.getSize(new h["Vector3"])},R=function(t,e,i){var n=d(2*e),r=d(e),a=g(t,2)*n/i,o=g(t*r,2)/(2*i);return{rangeR:a,rangeH:o}},O=function(t,e,i){var n=t.position.clone(),r=t.geometry.attributes.position,a=r.count,o=Array.from({length:a}).map((function(t,e){return(new h["Vector3"]).fromBufferAttribute(r,e)})).filter((function(t){return"z"===e&&i?t.z<0:"z"===e?t.z>0:"x"===e&&i?t.x<0:"x"===e?t.x>0:void 0})).map((function(e){var i=e.applyMatrix4(t.matrix);return i.sub(t.position)}));return function(t){for(var e,i=0;e=o[i];i++){var r=new h["Raycaster"](n,e.clone().normalize()),a=r.intersectObject(t,!0);if(a.length>0&&a[0].distance<e.length()+1.2)return!0}return!1}},D=function(t,e,i){var n=e.x,r=e.z,a=i.x,o=i.z,s=a-n,h=o-r,c=u(g(h,2)+g(s,2)),l=s*t/c,p=h*t/c;return{jumpDownX:n+l,jumpDownZ:r+p}},G=function(t,e,i){var n=t.from,r=t.to,a=t.duration,o=t.easing,s=void 0===o?function(t){return t}:o,h=t.autoStart,l=void 0===h||h,u=new c["a"].Tween(n).to(r,a).easing(s).onUpdate(e).onComplete((function(){i&&i()}));return l&&u.start(),I(),u},I=function t(){if(!t.openin){t.openin=!0;var e=function e(){var i=requestAnimationFrame(e);c["a"].update()||(t.openin=!1,cancelAnimationFrame(i))};e()}},k=(i("8e6e"),i("456d"),i("bd86"));function E(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function B(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?E(i,!0).forEach((function(e){Object(k["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):E(i).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Z=function(){function t(e){var i=e.width,n=e.height,r=e.canvas,a=e.axesHelper,s=void 0!==a&&a,h=e.cameraNear,c=e.cameraFar,l=e.cameraInitalPosition,u=e.lightInitalPosition;Object(o["a"])(this,t),this.width=i,this.height=n,this.canvas=r,this.axesHelper=s,this.cameraNear=h,this.cameraFar=c,this.cameraInitalPosition=l,this.lightInitalPosition=u,this.scene=null,this.plane=null,this.light=null,this.camera=null,this.renderer=null,this.init()}return Object(s["a"])(t,[{key:"init",value:function(){this.createScene(),this.createPlane(),this.createLight(),this.createCamera(),this.createRenterer(),this.render()}},{key:"destroy",value:function(){M(this.camera),M(this.light),M(this.plane),this.scene.remove(this.camera),this.scene.remove(this.light),this.scene.remove(this.plane),this.scene.children.forEach(M),this.scene.children=null,this.scene.dispose(),this.renderer.dispose(),this.canvas=null,this.scene=null,this.plane=null,this.light=null,this.camera=null,this.renderer=null}},{key:"reset",value:function(){var t=this.plane,e=this.light,i=this.lightTarget,n=this.lightInitalPosition,r=this.camera,a=this.cameraInitalPosition;t.position.x=0,t.position.z=0,i.position.x=0,i.position.z=0,e.position.set(n.x,n.y,n.z),r.position.x=a.x,r.position.z=a.z}},{key:"createScene",value:function(){var t=this.scene=new h["Scene"];t.background=new h["Color"](14080991),this.axesHelper&&t.add(new h["AxesHelper"](1e4))}},{key:"createPlane",value:function(){var t=this.scene,e=new h["PlaneBufferGeometry"](1e3,1e3,1,1),i=new h["ShadowMaterial"];i.opacity=.5;var n=this.plane=new h["Mesh"](e,i);n.rotation.x=-.5*Math.PI,n.position.y=-.1,n.receiveShadow=!0,t.add(n)}},{key:"createLight",value:function(){var t=this.scene,e=this.lightInitalPosition,i=e.x,n=e.y,r=e.z,a=this.height,o=this.light=new h["DirectionalLight"](16777215,.5),s=this.lightTarget=new h["Object3D"];o.target=s,o.position.set(i,n,r),o.castShadow=!0,o.shadow.camera.left=-a,o.shadow.camera.right=a,o.shadow.camera.top=a,o.shadow.camera.bottom=-a,o.shadow.camera.near=0,o.shadow.camera.far=2e3,o.shadow.mapSize.width=1600,o.shadow.mapSize.height=1600,t.add(new h["AmbientLight"](15067113,.4)),t.add(new h["HemisphereLight"](16777215,16777215,.2)),t.add(s),t.add(o)}},{key:"createCamera",value:function(){var t=this.scene,e=this.width,i=this.height,n=this.cameraInitalPosition,r=n.x,a=n.y,o=n.z,s=this.cameraNear,c=this.cameraFar,l=this.camera=new h["OrthographicCamera"](-e/2,e/2,i/2,-i/2,s,c);l.position.set(r,a,o),l.lookAt(t.position),t.add(l)}},{key:"createRenterer",value:function(){var t=this.canvas,e=this.width,i=this.height,n=this.renderer=new h["WebGLRenderer"]({canvas:t,alpha:!0,antialias:!0});n.setSize(e,i),n.shadowMap.enabled=!0,n.setPixelRatio(window.devicePixelRatio)}},{key:"render",value:function(){var t=this.scene,e=this.camera;this.renderer.render(t,e)}},{key:"moveCamera",value:function(t,e,i){var n=this,r=t.cameraTo,a=t.center,o=t.lightTo,s=this.camera,h=this.plane,c=this.light,l=this.lightTarget,u=this.lightInitalPosition;G({from:B({},s.position),to:r,duration:i},(function(t){var e=t.x,i=t.z;s.position.x=e,s.position.z=i,n.render()}),e);var p=u.x,g=u.z;G({from:B({},c.position),to:o,duration:i},(function(t){var e=t.x,i=t.y,n=t.z;l.position.x=e-p,l.position.z=n-g,c.position.set(e,i,n)})),h.position.x=a.x,h.position.z=a.z}},{key:"add",value:function(){var t;return(t=this.scene).add.apply(t,arguments)}},{key:"remove",value:function(){var t;return(t=this.scene).remove.apply(t,arguments)}}]),t}(),F=Z,Q=[],H=[function(t,e){var i=Object(a["a"])(e.propSizeRange,2),n=i[0],r=i[1],o=e.propHeight,s=e.baseMeshLambertMaterial,h=e.baseBoxBufferGeometry;w();var c=j(S),l=m<3?r:Y(n,r),u=h.clone();u.scale(l,o,l);var p=s.clone();return p.setValues({color:c}),new t.Mesh(u,p)},function(t,e){var i=Object(a["a"])(e.propSizeRange,2),n=i[0],r=i[1],o=e.propHeight,s=e.baseMeshLambertMaterial,h=e.baseCylinderBufferGeometry;w();var c=j(S),l=m<3?r:Y(n,r),u=h.clone();u.scale(Math.ceil(l/2),o,Math.ceil(l/2));var p=s.clone();return p.setValues({color:c}),new t.Mesh(u,p)}],L=function(){function t(e){var i=e.propHeight,n=e.propSizeRange,r=e.needDefaultCreator;Object(o["a"])(this,t),this.propHeight=i,this.propSizeRange=n,this.propCreators=[],r&&(this.createPropCreator(H,!1),this.createPropCreator(Q,!0))}return Object(s["a"])(t,[{key:"createProp",value:function(t){var e=this.propCreators;return t>-1&&e[t]&&e[t]()||j(e)()}},{key:"createPropCreator",value:function(t,e){var i=this;if(Array.isArray(t))t.forEach((function(t){return i.createPropCreator(t,e)}));else{var n=this.propCreators,r=this.propSizeRange,a=this.propHeight;if(!(n.indexOf(t)>-1)){var o=function i(){if(e&&i.box)return i.box.clone();var n=t(h,{propSizeRange:r,propHeight:a,baseMeshLambertMaterial:P,baseBoxBufferGeometry:A,baseCylinderBufferGeometry:z});return e&&(i.box=n),n};n.push(o)}}}}]),t}(),T=L,N=i("75fc"),U=function(){function t(e){var i=e.world,n=e.stage,r=e.body,a=e.height,s=e.enterHeight,h=e.distanceRange,c=e.prev;Object(o["a"])(this,t),this.world=i,this.stage=n,this.body=r,this.height=a,this.enterHeight=s,this.distanceRange=h,this.prev=c,this.nextDirection="",this.nextDistance=0}return Object(s["a"])(t,[{key:"computeMyPosition",value:function(){var t=this.world,e=this.prev,i=this.distanceRange,n=this.enterHeight,r={x:0,y:n,z:0};if(!e)return r;if(0===n)return r.z=t.width/2,e.nextDirection="z",r;var a=e.getPosition(),o=a.x,s=a.z,h=0===Math.round(Math.random()),c=e.getSize(),l=c.x,u=c.z,p=this.getSize(),g=p.x,d=p.z,f=Y.apply(void 0,Object(N["a"])(i));return h?(r.x=o+l/2+f+g/2,r.z=s,e.nextDirection="x"):(r.x=o,r.z=s+u/2+f+d/2,e.nextDirection="z"),e.nextDistance=f,r}},{key:"enterStage",value:function(){var t=this.stage,e=this.body,i=this.height,n=this.computeMyPosition(),r=n.x,a=n.y,o=n.z;e.castShadow=!0,e.receiveShadow=!0,e.position.set(r,a,o),e.geometry.translate(0,i/2,0),t.add(e),this.entranceTransition()}},{key:"entranceTransition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:400,e=this.body,i=this.enterHeight,n=this.stage;0!==i&&G({to:{y:0},from:{y:i},duration:t,easing:c["a"].Easing.Bounce.Out},(function(t){var i=t.y;e.position.setY(i),n.render()}))}},{key:"springbackTransition",value:function(t){var e=this.body,i=this.stage,n=e.scale.y;G({from:{y:n},to:{y:1},duration:t,easing:c["a"].Easing.Bounce.Out},(function(t){var n=t.y;e.scale.setY(n),i.render()}))}},{key:"computePointInfos",value:function(t,e,i){var n=this.body;if(!n)return{};var r=n.geometry.userData.type,a=this.getSize(),o=a.x,s=a.z,h=this.getPosition(),c=h.x,l=h.z,u=t/2;if("box"===r){var p=o/2,g=s/2,d=c-p,f=c+p,v=l-g,y=l+g,m=e>=d&&e<=f&&i>=v&&i<=y;if(m)return{contains:m};var w=Math.abs(i-l)-g,b=Math.abs(e-c)-p;if(w>=u||b>=u)return{contains:m};var S=!1,x=0,P=0;return e<f&&e>d?(i>y&&i<y+u?x=0:i<v&&i>v-u&&(x=180),S=!0,P=w):i<y&&i>v&&(e>f&&e<f+u?x=90:e<d&&e>d-u&&(x=270),S=!0,P=b),{contains:m,translateZ:P,isEdge:S,degY:x}}var A=o/2,z=Math.sqrt(Math.pow(c-e,2)+Math.pow(l-i,2)),M=z<=A;if(M)return{contains:M};if(z>=A+u)return{contains:M};var j=!0,Y=z-A,C=180*Math.atan(Math.abs(e-c)/Math.abs(i-l))/Math.PI;return e===c?C=i>l?0:180:i===l?C=e>c?90:270:e>c&&i>l||(C=e>c&&i<l?180-C:i<l?180+C:360-C),{contains:M,translateZ:Y,isEdge:j,degY:C}}},{key:"setNext",value:function(t){this.next=t}},{key:"getNext",value:function(){return this.next}},{key:"getPosition",value:function(){return this.body.position}},{key:"setPosition",value:function(t,e,i){return this.body.position.set(t,e,i)}},{key:"scaleY",value:function(t){return this.body.scale.setY(t)}},{key:"getSize",value:function(){return C(this.body)}},{key:"destroy",value:function(){this.prev&&(this.prev.next=null),this.next&&(this.next.prev=null),M(this.body),this.world=null,this.stage=null,this.body=null,this.prev=null,this.next=null}}]),t}(),V=U,X=function(){function t(e){var i=e.world,n=e.quantity,r=void 0===n?15:n,a=e.triggerObject;Object(o["a"])(this,t),this.world=i,this.quantity=r,this.triggerObject=a,this.particleSystem=null;var s=C(a),h=s.x,c=s.y;this.triggerObjectWidth=h;var l=this.flowSizeRange=[h/6,h/3];this.flowRangeY=[c/2,c-l[1]],this.initalY=l[1],this.flowRangeX=[2*-h,2*h];var u=this.fountainSizeRange=this.flowSizeRange.map((function(t){return t/2}));this.fountainRangeY=[u[1],c/3],this.fountainRangeDistance=[c/4,c/2],this.fountainRangeX=[-h/3,h/3],this.createParticle()}return Object(s["a"])(t,[{key:"destroy",value:function(){this.particleSystem&&(this.particleSystem.children.forEach(M),this.particleSystem.children=null,M(this.particleSystem)),this.world=null,this.triggerObject=null,this.particleSystem=null}},{key:"createParticle",value:function(){var t=this,e=this.quantity,n=this.triggerObject,r=new h["Color"](16777215),a=new h["Color"](5822093),o=Array.from({length:e}).map((function(t,e){return e%2?r:a})),s=this.particleSystem=new h["Group"];(new h["TextureLoader"]).load(i("e8df"),(function(e){var i=new h["Geometry"];i.vertices.push(new h["Vector3"]);var r=new h["PointsMaterial"]({size:0,map:e,transparent:!0});o.forEach((function(t){var e=i.clone(),n=r.clone();n.setValues({color:t});var a=new h["Points"](e,n);s.add(a)})),t.resetParticle(),n.add(s)}))}},{key:"resetParticle",value:function(){var t=this.particleSystem,e=this.initalY;t.children.forEach((function(t){t.position.y=e,t.position.x=0,t.position.z=0}))}},{key:"runParticleFlowPump",value:function(){var t=this.particleSystem,e=this.quantity,i=this.initalY,n=t.children.filter((function(t){return t.position.y===i}));if(!(n.length<e/3)){var r=this.triggerObjectWidth,a=this.flowRangeX,o=this.flowRangeY,s=this.flowSizeRange,h=r/2;n.forEach((function(t){var e=t.position,i=t.material,n=Y.apply(void 0,Object(N["a"])(a)),r=Y.apply(void 0,Object(N["a"])(a)),c=n<0?-h:h,l=r<0?-h:h;e.x=c+n,e.z=l+r,e.y=Y.apply(void 0,Object(N["a"])(o)),i.setValues({size:Y.apply(void 0,Object(N["a"])(s))})}))}}},{key:"runParticleFlow",value:function(){var t=this;if(!this.runingParticleFlow){this.runingParticleFlow=!0;var e=this.world,i=this.triggerObjectWidth,n=this.particleSystem,r=this.initalY,a=0,o=3*i/1e3,s=function i(){var s=requestAnimationFrame(i);if(t.runingParticleFlow){if(t.runParticleFlowPump(),a){var h=n.children.filter((function(t){return t.position.y!==r})),c=Date.now()-a,l=c*o;h.forEach((function(t){var e=t.position,i=e.x,n=e.y,a=e.z;if(n<r)e.y=r,e.x=0,e.z=0;else{var o=Math.sqrt(Math.pow(i,2)+Math.pow(a,2)+Math.pow(n-r,2)),s=(o-l)/o;e.x=s*i,e.z=s*a,e.y=s*n}})),e.stage.render()}a=Date.now()}else cancelAnimationFrame(s)};s()}}},{key:"stopRunParticleFlow",value:function(){this.runingParticleFlow=!1,this.resetParticle()}},{key:"runParticleFountainPump",value:function(t,e){var i=this,n=this.fountainRangeDistance,r=this.triggerObjectWidth,a=this.initalY,o=this.world;t.forEach((function(t){var e=t.position,i=e.x,a=e.y,o=e.z,s=t.userData;s.ty=a+Y.apply(void 0,Object(N["a"])(n));var h=Y(0,r/3);s.tx=(i<0?-h:h)+i;var c=Y(0,r/3);s.tz=(o<0?-c:c)+o}));var s=0,h=Date.now(),c=3*r/600,l=function n(){var r=requestAnimationFrame(n),l=t.filter((function(t){return t.position.y!==a}));if(l.length&&!i.runingParticleFlow&&Date.now()-h<e){if(s){var u=Date.now()-s,p=u*c;l.forEach((function(t){var e=t.position,i=t.position,n=i.x,r=i.y,o=i.z,s=t.userData,h=s.tx,c=s.ty,l=s.tz;if(r>=c)e.x=0,e.y=a,e.z=0;else{var u=h-n,g=c-r,d=l-o,f=Math.sqrt(Math.pow(u,2)+Math.pow(g,2)+Math.pow(d,2)),v=p/f;e.y+=v*g,e.x+=v*u,e.z+=v*d}})),o.stage.render()}s=Date.now()}else i.runingParticleFountain=!1,cancelAnimationFrame(r)};l()}},{key:"runParticleFountain",value:function(){if(!this.runingParticleFountain){this.runingParticleFountain=!0;var t=this.particleSystem,e=this.quantity,i=this.initalY,n=t.children.filter((function(t){return t.position.y===i})).slice(0,e);if(n.length){var r=this.triggerObjectWidth,a=this.fountainRangeX,o=this.fountainSizeRange,s=this.fountainRangeY,h=r/2;n.forEach((function(t){var e=t.position,i=t.material,n=Y.apply(void 0,Object(N["a"])(a)),r=Y.apply(void 0,Object(N["a"])(a)),c=n<0?-h:h,l=r<0?-h:h;e.x=c+n,e.z=l+r,e.y=Y.apply(void 0,Object(N["a"])(s)),i.setValues({size:Y.apply(void 0,Object(N["a"])(o))})})),this.runParticleFountainPump(n,1e3)}}}}]),t}(),J=X;function W(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function q(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?W(i,!0).forEach((function(e){Object(k["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):W(i).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var K=function(){function t(e){var i=e.world,n=e.color,r=e.G;Object(o["a"])(this,t),this.world=i,this.color=n,this.G=r,this.v0=i.width/10,this.theta=90,this.headSegment=null,this.bodyScaleSegment=null,this.bodyRotateSegment=null,this.body=null,this.unbindFunc=null,this.currentProp=null,this.nextProp=null,this.powerStorageDuration=1500,this.stage=null,this.createBody(),this.particle=new J({triggerObject:this.body,world:i}),this.resetPowerStorageParameter()}return Object(s["a"])(t,[{key:"destroy",value:function(){this.particle.destroy(),M(this.headSegment),M(this.bodyScaleSegment),M(this.bodyRotateSegment),M(this.body),this.unbindFunc&&this.unbindFunc(),this.world=null,this.particle=null,this.headSegment=null,this.bodyScaleSegment=null,this.bodyRotateSegment=null,this.body=null,this.unbindFunc=null,this.currentProp=null,this.nextProp=null,this.stage=null}},{key:"bindEvent",value:function(){var t=this,e=this.world.canvas,i="ontouchstart"in document,n=i?"touchstart":"mousedown",r=i?"touchend":"mouseup",a=function i(){t.jumping||(t.jumping=!0,t.poweringUp=!1,t.particle.stopRunParticleFlow(),t.jump(),e.removeEventListener(r,i))},o=function(i){i.preventDefault(),t.poweringUp||t.jumping||!t.currentProp||t.gameOver||(t.poweringUp=!0,t.particle.runParticleFlow(),t.powerStorage(),e.addEventListener(r,a,!1))};return e.addEventListener(n,o,!1),function(){e.removeEventListener(n,o),e.removeEventListener(r,a)}}},{key:"createBody",value:function(){var t=this.color,e=this.world.width,i=P.clone();i.setValues({color:t});var n=this.headSize=.03*e,r=this.headTranslateY=4.5*n,a=new h["SphereGeometry"](n,16,16),o=this.headSegment=new h["Mesh"](a,i);o.castShadow=!0,o.translateY(r),this.width=1.2*n*2,this.height=5*n,this.bodySize=4*n;var s=new h["CylinderBufferGeometry"](.9*n,this.width/2,2.5*n,16);s.translate(0,1.25*n,0);var c=new h["CylinderBufferGeometry"](n,.9*n,n,16);c.translate(0,3*n,0);var l=new h["SphereGeometry"](n,16,16);l.translate(0,3.5*n,0);var u=new h["Geometry"];u.merge(l),u.merge((new h["Geometry"]).fromBufferGeometry(c)),u.merge((new h["Geometry"]).fromBufferGeometry(s));var p=this.bodyTranslateY=1.5*n,g=this.bodyScaleSegment=new h["Mesh"](u,i);g.castShadow=!0,g.translateY(-p);var d=this.bodyRotateSegment=new h["Group"];d.add(o),d.add(g),d.translateY(p);var f=this.body=new h["Group"];f.add(d)}},{key:"enterStage",value:function(t,e,i){var n=e.x,r=e.y,a=e.z,o=this.body;o.position.set(n,r,a),this.stage=t,this.nextProp=i,t.add(o),t.render(),this.unbindFunc=this.bindEvent()}},{key:"resetPowerStorageParameter",value:function(){this.toValues={headTranslateY:0,bodyScaleXZ:0,bodyScaleY:0},this.fromValues=this.fromValues||{headTranslateY:this.headTranslateY,bodyScaleXZ:1,bodyScaleY:1,propScaleY:1}}},{key:"powerStorage",value:function(){var t=this,e=this.stage,i=this.powerStorageDuration,n=this.body,r=this.bodyScaleSegment,a=this.headSegment,o=this.bodySize,s=this.fromValues,h=this.currentProp,c=this.world.propHeight;this.powerStorageTime=Date.now(),this.resetPowerStorageParameter();var l=G({from:q({},s),to:{headTranslateY:o-.6*o,bodyScaleXZ:1.3,bodyScaleY:.6,propScaleY:.6},duration:i},(function(i){var o=i.headTranslateY,s=i.bodyScaleXZ,u=i.bodyScaleY,p=i.propScaleY;t.poweringUp?(a.position.setY(o),r.scale.set(s,u,s),h.scaleY(p),n.position.setY(c*p),t.toValues={headTranslateY:o,bodyScaleXZ:s,bodyScaleY:u},e.render()):l.stop()}))}},{key:"computePowerStorageValue",value:function(){var t=this.powerStorageDuration,e=this.powerStorageTime,i=this.v0,n=this.theta,r=Date.now()-e,a=Math.min(r,t),o=a/t;return{v0:i+30*o,theta:n-40*o}}},{key:"jump",value:function(){var t=this,e=this.stage,i=this.body,n=this.currentProp,r=this.nextProp,a=this.world.propHeight,o=400,s=i.position,h=r.getPosition(),l=s.x,u=s.y,p=s.z;if(n||l!==h.x||p!==h.z){if(!n)return;var g=this.bodyScaleSegment,d=this.headSegment,f=this.G,v=this.world,y=this.width,m=this.computePowerStorageValue(),w=m.v0,b=m.theta,S=R(w,b*(Math.PI/180),f),x=S.rangeR,P=S.rangeH,A=D(x,s,h),z=A.jumpDownX,M=A.jumpDownZ;G({from:q({x:l,z:p},this.toValues),to:q({x:z,z:M},this.fromValues),duration:o},(function(t){var e=t.x,n=t.z,r=t.headTranslateY,a=t.bodyScaleXZ,o=t.bodyScaleY;i.position.setX(e),i.position.setZ(n),d.position.setY(r),g.scale.set(a,o,a)}));var j=Math.max(v.width/3,P)+a,Y=G({from:{y:u},to:{y:j},duration:.65*o,easing:c["a"].Easing.Cubic.Out,autoStart:!1},(function(t){var e=t.y;i.position.setY(e)})),C=G({from:{y:j},to:{y:a},duration:.35*o,easing:c["a"].Easing.Cubic.In,autoStart:!1},(function(t){var e=t.y;i.position.setY(e)}),(function(){return O()}));Y.chain(C).start(),this.flip(o),n.springbackTransition(500);var O=function(){var e=n.computePointInfos(y,z,M),i=r.computePointInfos(y,z,M);e.contains||i.contains?I.onComplete((function(){i.contains&&(v.createProp(),v.moveCamera(),t.currentProp=r,t.nextProp=r.getNext()),t.particle.runParticleFountain(),t.jumping=!1})).start():(console.log("GameOver"),t.fall(e,i))},I=G({from:{s:.8},to:{s:1},duration:100,autoStart:!1},(function(t){var e=t.s;g.scale.setY(e)}))}else G({from:{y:u},to:{y:a},duration:o,easing:c["a"].Easing.Bounce.Out},(function(t){var n=t.y;i.position.setY(n),e.render()}),(function(){t.currentProp=r,t.nextProp=r.getNext(),t.jumping=!1}))}},{key:"flip",value:function(t){var e=this.currentProp,i=this.bodyRotateSegment,n=0;G({from:{deg:0},to:{deg:360},duration:t,easing:c["a"].Easing.Sinusoidal.InOut},(function(t){var r=t.deg;"x"===e.nextDirection?i.rotateZ(-(r-n)*(Math.PI/180)):i.rotateX((r-n)*(Math.PI/180)),n=r}))}},{key:"fall",value:function(t,e){var i,n,r,a,o=this.stage,s=this.body,h=this.currentProp,l=this.nextProp,u=this.world.propHeight,p=h.nextDirection;if(!t.isEdge||!e.isEdge){if(t.isEdge)i=t.degY,n=t.translateZ,r=l,a=!0;else{if(!e.isEdge)return G({from:{y:u},to:{y:0},duration:400,easing:c["a"].Easing.Bounce.Out},(function(t){var e=t.y;s.position.setY(e),o.render()}));i=e.degY,n=e.translateZ,a="z"===p?i<90&&i>270:i<180,r=a?null:h}this.particle.destroy();var g=this.bodyRotateSegment,d=this.bodyScaleSegment,f=this.headSegment,v=this.bodyTranslateY,y=this.width,m=this.height,w=y/2;f.translateY(v),d.translateY(v),g.translateY(-v),g.rotateY(i*(Math.PI/180)),f.translateZ(n),d.translateZ(n),g.translateZ(-n);var b=0,S=0,x=0,P=r&&O(r.body,p,a),A=G({from:{degY:0},to:{degY:90},duration:500,autoStart:!1,easing:c["a"].Easing.Quintic.In},(function(t){var e=t.degY;P&&P(s.children[0])?(A.stop(),P=null):(g.rotateX((e-S)*(Math.PI/180)),S=e,o.render())})),z=u-w-n,M=G({from:{y:0,z:0},to:{y:w-n,z:z},duration:300,autoStart:!1,easing:c["a"].Easing.Bounce.Out},(function(t){var e=t.z,i=t.y;if(P&&P(s.children[0])){M.stop();var n=Math.atan((z-e)/m);a&&"z"===p?(g.translateY(-m),s.position.z+=m,s.rotateX(-n)):"z"===p?(g.translateY(-m),s.position.z-=m,s.rotateX(n)):a&&"x"===p?(g.translateY(-m),s.position.x+=m,s.rotateZ(n)):"x"===p&&(g.translateY(-m),s.position.x-=m,s.rotateZ(-n)),o.render(),P=null}else f.translateZ(e-b),d.translateZ(e-b),g.translateY(i-x),b=e,x=i,o.render()}));A.chain(M).start()}}}]),t}(),_=K,$=function(){function t(e){var i=e.container,n=e.canvas,r=e.needDefaultCreator,a=void 0===r||r,s=e.axesHelper,h=void 0!==s&&s;Object(o["a"])(this,t);var c=i.offsetWidth,l=i.offsetHeight;this.G=9.8,this.container=i,this.canvas=n,this.width=c,this.height=l,this.needDefaultCreator=a,this.axesHelper=h;var u=~~(c/6),p=~~(c/3.5);this.propSizeRange=[u,p],this.propHeight=~~(p/2),this.propDistanceRange=[~~(u/2),2*p],this.stage=null,this.propCreator=null,this.littleMans=[],this.props=[],this.init()}return Object(s["a"])(t,[{key:"init",value:function(){this.initStage(),this.initPropCreator(),this.computeSafeClearLength(),this.createProp(0),this.createProp(0),this.moveCamera(0),this.initLittleMan()}},{key:"destroy",value:function(){this.clear()}},{key:"clear",value:function(){this.stage&&this.stage.reset(),this.props.forEach((function(t){return t.destroy()})),this.props=[],b(),this.littleMans.forEach((function(t){return t.destroy()})),this.littleMans=[]}},{key:"initStage",value:function(){var t=this.canvas,e=this.axesHelper,i=this.width,n=this.height,r=.1,a=2e3,o=this.cameraInitalPosition=x(35,225,n/2,n/2,r,a),s=this.lightInitalPosition={x:-300,y:600,z:200};this.stage=new F({width:i,height:n,canvas:t,axesHelper:e,cameraNear:r,cameraFar:a,cameraInitalPosition:o,lightInitalPosition:s})}},{key:"initPropCreator",value:function(){var t=this.needDefaultCreator,e=this.propSizeRange,i=this.propHeight;this.propCreator=new T({propHeight:i,propSizeRange:e,needDefaultCreator:t})}},{key:"createPropCreator",value:function(){var t;(t=this.propCreator).createPropCreator.apply(t,arguments)}},{key:"initLittleMan",value:function(){var t=this.stage,e=this.propHeight,i=this.G,n=this.props,r=new _({world:this,color:3696793,G:i});r.enterStage(t,{x:0,y:e+80,z:0},n[0]),r.jump(),this.littleMans.push(r)}},{key:"createProp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=this.propCreator,n=this.propHeight,r=Object(a["a"])(this.propSizeRange,2),o=r[0],s=r[1],h=this.propDistanceRange,c=this.stage,l=this.props,u=this.props.length,p=l[u-1],g=new V({world:this,stage:c,body:i.createProp(-1===e&&u<3?0:e),height:n,prev:p,enterHeight:t,distanceRange:h}),d=g.getSize();return d.y!==n&&console.warn("高度: ".concat(d.y,",盒子高度必须为 ").concat(n)),(d.x<o||d.x>s)&&console.warn("宽度: ".concat(d.x,", 盒子宽度必须为 ").concat(o," - ").concat(s)),(d.z<o||d.z>s)&&console.warn("深度: ".concat(d.z,", 盒子深度度必须为 ").concat(o," - ").concat(s)),p&&p.setNext(g),g.enterStage(),l.push(g),g}},{key:"moveCamera",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,i=this.stage,n=this.height,r=this.cameraInitalPosition,a=r.x,o=r.y,s=r.z,h=this.lightInitalPosition,c=h.x,l=h.y,u=h.z,p=n/10,g=this.getLastTwoCenterPosition(),d=g.x,f=g.y,v=g.z,y={x:d+a+p,y:o,z:v+s+p},m={x:d+c,y:l,z:v+u},w={cameraTo:y,lightTo:m,center:{x:d,y:f,z:v}};i.moveCamera(w,(function(){t.clearProps()}),e)}},{key:"getLastTwoCenterPosition",value:function(){var t=this.props,e=this.props.length,i=t[e-2].getPosition(),n=i.x,r=i.z,a=t[e-1].getPosition(),o=a.x,s=a.z;return{x:n+(o-n)/2,z:r+(s-r)/2}}},{key:"clearProps",value:function(){var t=this.safeClearLength,e=this.props,i=this.props.length,n=4;i>t&&(e.slice(0,n).forEach((function(t){return t.destroy()})),this.props=e.slice(n))}},{key:"computeSafeClearLength",value:function(){var t=this.width,e=this.height,i=this.propSizeRange,n=i[0],r=Math.sqrt(n*n+n*n);this.safeClearLength=Math.ceil(t/n)+Math.ceil(e/r/2)+1}}]),t}(),tt=$,et={mounted:function(){new tt({container:document.querySelector(".jump-world"),canvas:document.querySelector("#jump-world-canvas"),axesHelper:!0})}},it=et,nt=(i("8fad"),i("2877")),rt=Object(nt["a"])(it,n,r,!1,null,"9a0b2f7a",null);e["default"]=rt.exports},e8df:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REVGODRBRjIyRjU2MTFFNUExM0Y4OUExMTc4QTBCQUMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REVGODRBRjMyRjU2MTFFNUExM0Y4OUExMTc4QTBCQUMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpERUY4NEFGMDJGNTYxMUU1QTEzRjg5QTExNzhBMEJBQyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpERUY4NEFGMTJGNTYxMUU1QTEzRjg5QTExNzhBMEJBQyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgDz1z0AAAZeSURBVHja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"}}]);